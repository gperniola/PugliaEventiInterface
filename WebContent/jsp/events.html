<!DOCTYPE html>
<html lang="en">
<head>
    <!-- ========== Meta Tags ========== -->
    <meta charset="UTF-8">
    <meta name="description" content="Evento -Event Html Template">
    <meta name="keywords" content="Evento , Event , Html, Template">
    <meta name="author" content="ColorLib">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <!-- ========== Title ========== -->
    <title> Evento - Event Html Template</title>
    <!-- ========== Favicon Ico ========== -->
    <!--<link rel="icon" href="fav.ico">-->
    <!-- ========== STYLESHEETS ========== -->
    <!-- Bootstrap CSS -->
    <!--<link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap2-toggle.min.css" rel="stylesheet">-->
    <link href="assets/css/bootstrap.min.css" rel="stylesheet">
    <!-- Fonts Icon CSS -->
    <link href="assets/css/font-awesome.min.css" rel="stylesheet">
    <link href="assets/css/et-line.css" rel="stylesheet">
    <link href="assets/css/ionicons.min.css" rel="stylesheet">
    <!-- Carousel CSS -->
    <link href="assets/css/owl.carousel.min.css" rel="stylesheet">
    <link href="assets/css/owl.theme.default.min.css" rel="stylesheet">
    <!-- Animate CSS -->
    <link rel="stylesheet" href="assets/css/animate.min.css">
    <!-- Custom styles for this template -->
    <link href="assets/css/main.css" rel="stylesheet">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.0/themes/smoothness/jquery-ui.css">
    
    <link href="assets/css/spinner.css" rel="stylesheet">

	<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />


</head>

<body onload="loadAllEvents();"> 
<div class="loader">
    <div class="loader-outter"></div>
    <div class="loader-inner"></div>
</div>

<!--header start here -->
<header class="header navbar fixed-top navbar-expand-md">
    <div class="container">
        <a class="navbar-brand logo" href="#">
            <img src="assets/img/logo.png" alt="Evento"/>
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#headernav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="lnr lnr-text-align-right"></span>
        </button>
        <div class="collapse navbar-collapse flex-sm-row-reverse" id="headernav">
            <ul class=" nav navbar-nav menu">
                <li class="nav-item">
                    <a class="nav-link active" href="index.html">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link " href="profile.html" >Personal Page</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link " href="#" >Eventi</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link " href="places.html" >Luoghi</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link " href="recommender.html" >Recommender</a>
                </li>
            </ul>
        </div>
    </div>
</header>
<!--header end here-->

<!--page title section-->
<section class="inner_cover parallax-window" data-parallax="scroll" data-image-src="assets/img/bg/bg-img.png">
    <div class="overlay_dark"></div>
    <div class="container">
        <div class="row justify-content-center align-items-center">
            <div class="col-12">
                <div class="inner_cover_content">
                    <h3>
                       Eventi sul territorio dei prossimi giorni!
                    </h3>
                </div>
            </div>
        </div>

        <div class="breadcrumbs">
            <ul>
                <li><a href="#">Home</a>  |   </li>
                <li><span>Events</span></li>
            </ul>
        </div>
    </div>
</section>
<!--page title section end-->


<!--events section -->
<section class="pt100 pb100">
    <div class="container">
    	<div>
  			<h5>Filtra i nostri eventi</h5>
  			<!--Nome evento:&nbsp;&nbsp;<input type="text" id="nome" width="50px" nome ="nome" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-->
			<!--  <form id="cercaEventi" name = "cercaEventi" enctype='multipart/form-data'> -->
  			<form>
				<div class="form-group form-inline">
					<label for="comune" class="col-sm-2 col-form-label">Citt√† in cui cercare </label>
					<div class="col-sm-4"><input type="text" class="form-control" id="comune" name="comune"  nome ="comune" /></div>
				</div>
				<div class="form-group form-inline">
					<label for="daterange" class="col-sm-2 col-form-label">Intervallo di tempo</label>
					<div class="col-sm-4"><input class="form-control" type="text" name="daterange" id="daterange" /></div>
				</div>
				<div class="form-group form-inline">
					<label for="slider" class="col-sm-2 col-form-label">Raggio di ricerca </label>
					<div class="col-sm-4"><span id="slider" style="width:100px;display:inline-block"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><span id="slider-value">50</span>&nbsp;km</strong></div>
				</div>
				<div class="form-group form-inline">
					<label for="sliderMeteo" class="col-sm-2 col-form-label">Condizioni meteo </label>
					<div class="col-sm-4"><span id="sliderMeteo" style="width:100px;display:inline-block"></span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><span id="sliderMeteo-label">Qualsiasi</span></strong><span class="d-none" id="sliderMeteo-value">0</span></div>
				</div>
				<div class="form-group form-inline">
  					<label class="form-check-label col-sm-5" for="checkNoMeteoData">Mostra eventi con previsioni non disponibili nelle date indicate</label>
  					<input class="form-check-input" type="checkbox" value="" id="checkNoMeteoData" checked>	
				</div>
				<!-- 
 				<div class="form-group form-inline">
 					<label class="col-sm-2 col-form-label">Intervallo di tempo</label>
    				<div class="form-check col-sm-2">
				  		<input class="form-check-input" type="radio"  name="date" id="radio1" value="1d">
				  		<label class="form-check-label" for="radio1"><strong>Oggi</strong></label>
					</div>
					<div class="form-check col-sm-2">
				  		<input class="form-check-input" type="radio"  name="date" id="radio2" value="7d" checked>
				  		<label class="form-check-label" for="radio2"><strong>Prossimi 7 giorni</strong></label>
					</div>
					<div class="form-check col-sm-2">
				  		<input class="form-check-input" type="radio"  name="date" id="radio3" value="1m">
				  		<label class="form-check-label" for="radio3"><strong>Prossimi 30 giorni</strong></label>
					</div>
					<div class="form-check col-sm-2">
				  		<input class="form-check-input" type="radio"  name="date" id="radio4" value="6m">
				  		<label class="form-check-label" for="radio4"><strong>Prossimi 6 mesi</strong></label>
					</div>
    			</div>
	    		 -->
	    		<div class="form-group">
	    			<a  class=" btn btn-primary btn-rounded mb-2" style="color:white;" onclick="loadAllEvents();">Cerca eventi</a>
	    		</div>
  			</form>
		</div>
		
    	<div class="border border-danger" style="margin-top:5px; margin-bottom:15px;"></div>
    	<div id ="waiting"></div>


	<div style="display: inline-block; padding-right:15px;" id="listPlaceholder"><h1>Eventi</h1></div>
	<div style="display: inline-block;"><h3 id="counterEvents"></h3></div>


<div id ="eventiContainer" name ="eventiContainer">
</div>
   <ul id="pagination-demo" class="pagination-sm"></ul>
</div>
</section>
<!--event section end -->


<!--footer start -->
<footer>
    <div class="container">
        <div class="row justify-content-center">

            <div class="col-md-4 col-12">
                <div class="footer_box">
                    <div class="footer_header">
                        <div class="footer_logo">
                            <img src="assets/img/logo.png" alt="evento">
                        </div>
                    </div>
                    <div class="footer_box_body">
                        <p>
                            Lorem ipsum dolor sit amet, consectetur adipiscing elit. In rhoncus massa nec gravida tempus. Integer iaculis in aazzzCurabitur a pulvinar nunc. Maecenas laoreet finibus lectus, at volutpat ligula euismod.
                        </p>
                        <ul class="footer_social">
                            <li>
                                <a href="#"><i class="ion-social-pinterest"></i></a>
                            </li>
                            <li>
                                <a href="#"><i class="ion-social-facebook"></i></a>
                            </li>
                            <li>
                                <a href="#"><i class="ion-social-twitter"></i></a>
                            </li>
                            <li>
                                <a href="#"><i class="ion-social-dribbble"></i></a>
                            </li>
                            <li>
                                <a href="#"><i class="ion-social-instagram"></i></a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="col-12 col-md-4">
                <div class="footer_box">
                    <div class="footer_header">
                        <h4 class="footer_title">
                            instagram
                        </h4>
                    </div>
                    <div class="footer_box_body">
                        <ul class="instagram_list">
                            <li>
                                <a href="#">
                                    <img src="assets/img/cleander/c1.png" alt="instagram">
                                </a>
                            </li>
                            <li>
                                <a href="#">
                                    <img src="assets/img/cleander/c2.png" alt="instagram">
                                </a>
                            </li>
                            <li>
                                <a href="#">
                                    <img src="assets/img/cleander/c3.png" alt="instagram">
                                </a>
                            </li>
                            <li>
                                <a href="#">
                                    <img src="assets/img/cleander/c3.png" alt="instagram">
                                </a>
                            </li>
                            <li>
                                <a href="#">
                                    <img src="assets/img/cleander/c2.png" alt="instagram">
                                </a>
                            </li>
                            <li>
                                <a href="#">
                                    <img src="assets/img/cleander/c1.png" alt="instagram">
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="col-12 col-md-4">
                <div class="footer_box">
                    <div class="footer_header">
                        <h4 class="footer_title">
                            subscribe to our newsletter
                        </h4>
                    </div>
                    <div class="footer_box_body">
                        <div class="newsletter_form">
                            <input type="email" class="form-control" placeholder="E-Mail here">
                            <button class="btn btn-rounded btn-block btn-primary">SUBSCRIBE</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</footer>
<div class="copyright_footer">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-6 col-12">
                <p><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="fa fa-heart-o" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Colorlib</a>
<!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. --></p>
            </div>
            <div class="col-12 col-md-6 ">
                <ul class="footer_menu">
                    <li>
                        <a href="#">Home</a>
                    </li>
                    <li>
                        <a href="#">Speakers</a>
                    </li>
                    <li>
                        <a href="#">Events</a>
                    </li>
                    <li>
                        <a href="#">News</a>
                    </li>
                    <li>
                        <a href="#">Contact</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>
<!--footer end -->

<!-- jquery -->
<script src="assets/js/jquery.min.js"></script>
<!-- bootstrap -->
<script src="assets/js/popper.js"></script>
<script src="assets/js/bootstrap.min.js"></script>
<script src="assets/js/waypoints.min.js"></script>
<!--slick carousel -->
<script src="assets/js/owl.carousel.min.js"></script>
<!--parallax -->
<script src="assets/js/parallax.min.js"></script>
<!--Counter up -->
<script src="assets/js/jquery.counterup.min.js"></script>
<!--Counter down -->
<script src="assets/js/jquery.countdown.min.js"></script>
<!-- WOW JS -->
<script src="assets/js/wow.min.js"></script>
<!-- Custom js -->
<script src="assets/js/main.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twbs-pagination/1.4.2/jquery.twbsPagination.js"></script>


<!-- Date picker -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
	
<!-- Custom js - Functions -->
<script src="assets/js/utils.js"></script> 
	
<script>
$(document).ready(function(){ 
	document.getElementById("comune").value = sessionStorage.getItem('userLocation');
});


$("#slider").slider(
{
            value:50,
            min: 0,
            max: 200,
            step: 10,
            slide: function( event, ui ) {
                $( "#slider-value" ).html( ui.value );
            }
}
);

$("#sliderMeteo").slider(
		{
            value:0,
            min: 0,
            max: 4,
            step: 1,
            slide: function( event, ui ) {
            	var descr = "";
            	if (ui.value == 0) descr = "Qualsiasi";
            	if (ui.value == 1) descr = "Pioggia o migliore";
            	if (ui.value == 2) descr = "Nuvoloso o migliore";
            	if (ui.value == 3) descr = "Sereno o poco nuvoloso";
            	if (ui.value == 4) descr = "Solo sereno";
                $( "#sliderMeteo-label" ).html(descr);
                $( "#sliderMeteo-value" ).html(ui.value);
            }
		}
);




$(function() {
	  $('input[name="daterange"]').daterangepicker({
	    ranges: {
	        'Oggi': [moment(), moment()],
	        'Prossimi 7 giorni': [moment(), moment().add(7, 'days')],
	        'Prossimo mese': [moment(), moment().add(30, 'days')],
	        'Prossimi 6 mesi': [moment(), moment().add(6,'months')],
	    },
		minDate:moment(),
		startDate: moment(),
		endDate: moment().add(7,'days'),
		"maxSpan": {
	        "months": 6
	    },
		locale: {
		      format: 'DD/MM/YYYY'
		}
	  }, function(start, end, label) {
	    console.log("A new date selection was made: " + start.format('YYYY-MM-DD') + ' to ' + end.format('YYYY-MM-DD'));
	    start_date = start.format('YYYY-MM-DD');
	    end_date = end.format('YYYY-MM-DD');
	  });
	});

	




function loadAllEvents() {
	document.getElementById("waiting").innerHTML ='<div style="text-align:center;"><div class="lds-dual-ring"></div><div><h5>Recupero dati in corso..</h5></div></div>';
	document.getElementById("eventiContainer").innerHTML ="";
	document.getElementById("listPlaceholder").innerHTML ="";
	document.getElementById("counterEvents").innerHTML =""
	var noWeatherData = 0;
	if (document.getElementById("checkNoMeteoData").checked) noWeatherData = 1;
	
    $.ajax({
        type: 'post',
        url: 'http://127.0.0.1:8000/api/getAllEvents/',
        data:{
        	//'days':$("input[name=date]:checked").val(),
        	'location':document.getElementsByName('comune')[0].value,
        	'range':document.getElementById("slider-value").innerHTML,
        	'weather': document.getElementById("sliderMeteo-value").innerHTML,
        	'no-weather-data': noWeatherData,
        	'start-date': start_date,
        	'end-date': end_date
        },
        success: function (response) {
        	allEvents = response;
        	document.getElementById("waiting").innerHTML = "";
        	makePages(allEvents.length, 0);
        	document.getElementById("listPlaceholder").innerHTML= "<h1>Eventi </h1>";
        	document.getElementById("counterEvents").innerHTML= " ("+ allEvents.length + " trovati)";
        	loadPageEvents(1);
        	
        },
        error: function(e) {
          var je = JSON.parse(e.responseText);
           alert("ko");
        }
    });
}

function loadPageEvents(page){
	var pageOffset =  ((page*10)-10);
	$("#eventiContainer").html("");
	for (var i = pageOffset; i < Math.min((page*10), allEvents.length); i++){
        printEventi(allEvents[i],i, i, "eventiContainer");
      }
}



</script>

</body>
</html>
